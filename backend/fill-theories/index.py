'''
Business: Заполняет базу данных 38 фанатскими теориями о Рик и Морти
Args: event - HTTP event с методом GET
      context - контекст выполнения функции
Returns: HTTP response с результатом заполнения
'''
import json
import psycopg2
import os
from typing import Dict, Any

THEORIES_DATA = [
    {
        "title": "Злой Морти - это будущий Морти С-137",
        "type": "character",
        "probability": "high",
        "author": "Александр Теоретик",
        "summary": "Злой Морти может быть будущей версией нашего Морти, который устал от манипуляций Рика и решил отомстить всем Рикам во мультивселенной.",
        "full_text": "Теория основывается на том, что Злой Морти демонстрирует интеллект и жестокость, которые могли развиться у Морти С-137 после долгих лет приключений с Риком. Его план по уничтожению Центральной Кривой Конечности показывает глубокое понимание мультивселенной.",
        "evidence": "Злой Морти знает про портал-пушку больше, чем обычный Морти. Он управляет другим Риком через имплант в мозге. Его мотивация - освобождение от влияния Риков.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/b050bbda-cc42-404f-8ab0-ea7f07638e47.png"
    },
    {
        "title": "Рик С-137 не самый умный Рик",
        "type": "multiverse",
        "probability": "medium",
        "author": "Мария Аналитик",
        "summary": "Центральная Кривая Конечности может скрывать Риков умнее С-137, но они специально держатся в тени, чтобы не привлекать внимание.",
        "full_text": "Рик С-137 считается самым умным, но это может быть иллюзией. Возможно, существуют Рики, которые настолько умны, что понимают бессмысленность конкуренции и просто наблюдают со стороны.",
        "evidence": "Простой Рик был счастлив без науки. Weird Rick существовал вне системы. Некоторые Рики выбрали другой путь развития.",
        "category": "Мультивселенная",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/1d3d8e78-1f50-4e16-bb65-f7c0fb77aedd.png"
    },
    {
        "title": "Бет - клон, оригинал улетела в космос",
        "type": "character",
        "probability": "confirmed",
        "author": "Дмитрий Сыщик",
        "summary": "В серии про космическую Бет Рик создал клон, и мы до сих пор не знаем, какая Бет настоящая.",
        "full_text": "Рик предложил Бет выбор - остаться с семьёй или отправиться в космические приключения. Он создал клон и перемешал их, чтобы даже сам не знать, кто есть кто. Это защищает обеих Бет.",
        "evidence": "Рик прямо показал процесс клонирования. Космическая Бет периодически появляется. Обе Бет ведут себя идентично.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/3e9c1b25-dca3-4f8b-93ae-2b4fc3e8f9ba.png"
    },
    {
        "title": "Мистер Попибаттхол - паразит из 2 сезона",
        "type": "character",
        "probability": "low",
        "author": "Елена Конспиролог",
        "summary": "Теория гласит, что Мистер Попибаттхол на самом деле паразит, который научился создавать негативные воспоминания.",
        "full_text": "В отличие от паразитов из 2 сезона, Мистер Попибаттхол эволюционировал и может создавать любые воспоминания. Его появление в семье Смитов никогда толком не объяснялось.",
        "evidence": "Никто не помнит, откуда он появился. Он пережил выстрел Бет. Его история слишком идеальна для реальности.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/5f1a2c3d-4e5f-6a7b-8c9d-0e1f2a3b4c5d.png"
    },
    {
        "title": "Жена Рика всё ещё жива",
        "type": "character",
        "probability": "medium",
        "author": "Сергей Романтик",
        "summary": "Диана, жена Рика, может быть жива в другом измерении, и Рик ищет её через всю мультивселенную.",
        "full_text": "Смерть Дианы и Бет была показана в воспоминаниях, но в мире бесконечных вселенных должна существовать версия, где она выжила. Это может быть настоящая мотивация Рика.",
        "evidence": "Рик изобрёл портал-пушку после смерти жены. Он ищет убийцу через все вселенные. Его депрессия может быть связана с невозможностью найти её.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d.png"
    },
    {
        "title": "Морти станет умнее Рика",
        "type": "future",
        "probability": "high",
        "author": "Ольга Провидица",
        "summary": "Морти постепенно перенимает знания Рика и в будущем может превзойти его, став самым умным во вселенной.",
        "full_text": "На протяжении сериала Морти становится всё более компетентным. Он научился управлять кораблём, понимает основы науки Рика и даже манипулирует ситуациями. Злой Морти - пример этого развития.",
        "evidence": "Морти управляет кораблём без Рика. Он понимает мультивселенную. Злой Морти показал потенциал Морти с опытом.",
        "category": "Будущее",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/9b0c1d2e-3f4a-5b6c-7d8e-9f0a1b2c3d4e.png"
    },
    {
        "title": "Джерри - секретный гений",
        "type": "character",
        "probability": "low",
        "author": "Максим Оптимист",
        "summary": "Джерри специально прикидывается глупым, чтобы Рик не видел в нём угрозу.",
        "full_text": "Во вселенной, где Джерри и Бет не встретились, Джерри стал успешным актёром. Это показывает, что его глупость может быть защитным механизмом в присутствии Рика.",
        "evidence": "В некоторых ситуациях Джерри показывает неожиданную компетентность. Он выжил в постапокалиптическом мире. Его отношения с семьёй стабильнее всех.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/1c2d3e4f-5a6b-7c8d-9e0f-1a2b3c4d5e6f.png"
    },
    {
        "title": "Центральная Кривая Конечности - тюрьма",
        "type": "multiverse",
        "probability": "confirmed",
        "author": "Анна Философ",
        "summary": "ЦКК создана как тюрьма для Риков, чтобы они не могли свободно перемещаться по мультивселенной.",
        "full_text": "Злой Морти разрушил Центральную Кривую Конечности и вырвался за её пределы. Это подтверждает, что ЦКК ограничивала доступ к определённым вселенным. Рики были заперты в своей части мультивселенной.",
        "evidence": "Злой Морти назвал это тюрьмой. За пределами ЦКК существуют другие вселенные. Портал-пушки работали только внутри ЦКК.",
        "category": "Мультивселенная",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/3d4e5f6a-7b8c-9d0e-1f2a-3b4c5d6e7f8a.png"
    },
    {
        "title": "Рик С-137 убил других Риков",
        "type": "multiverse",
        "probability": "confirmed",
        "author": "Владимир Детектив",
        "summary": "Рик С-137 в прошлом истреблял других Риков, мстя за смерть жены и дочери.",
        "full_text": "В серии про воспоминания показано, как молодой Рик убивает других Риков. Он искал того, кто убил его семью, и в процессе уничтожил множество версий себя.",
        "evidence": "Показаны воспоминания Рика. Совет Риков боится С-137. Его называют самым опасным Риком.",
        "category": "Мультивселенная",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/5e6f7a8b-9c0d-1e2f-3a4b-5c6d7e8f9a0b.png"
    },
    {
        "title": "Саммер - самый важный член семьи",
        "type": "character",
        "probability": "medium",
        "author": "Ирина Феминистка",
        "summary": "Саммер обладает уникальной способностью объединять семью и может стать ключевой фигурой в финале.",
        "full_text": "Саммер часто выступает голосом разума и способна влиять как на Рика, так и на Морти. Её эмоциональный интеллект превосходит всех членов семьи, что делает её незаменимой.",
        "evidence": "Саммер спасала семью несколько раз. Рик доверяет ей серьёзные задания. Она единственная может успокоить Рика.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/7f8a9b0c-1d2e-3f4a-5b6c-7d8e9f0a1b2c.png"
    },
    {
        "title": "Мультивселенная - симуляция",
        "type": "science",
        "probability": "medium",
        "author": "Андрей Программист",
        "summary": "Вся мультивселенная может быть компьютерной симуляцией, и Рик знает об этом.",
        "full_text": "Рик несколько раз упоминал симуляции и показывал, что может взламывать реальность. Возможно, он понял, что живёт в симуляции, и это объясняет его нигилизм.",
        "evidence": "Рик взламывает реальность как код. Он говорил про симуляции в симуляциях. Его способности больше похожи на читы в игре.",
        "category": "Наука",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d.png"
    },
    {
        "title": "Птичья Личность вернётся",
        "type": "future",
        "probability": "high",
        "author": "Екатерина Оптимистка",
        "summary": "Птичья Личность не умер и вернётся, чтобы помочь Рику в финальной битве.",
        "full_text": "Смерть Птичьей Личности не была показана явно. В мультивселенной он мог выжить или существует его версия из другого измерения. Рик нуждается в союзниках.",
        "evidence": "Смерть не показали прямо. Рик скучает по другу. Птичья Личность был важным персонажем.",
        "category": "Будущее",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/1b2c3d4e-5f6a-7b8c-9d0e-1f2a3b4c5d6e.png"
    },
    {
        "title": "Морти С-137 заменён",
        "type": "character",
        "probability": "low",
        "author": "Николай Параноик",
        "summary": "Нынешний Морти не тот, с которым начинал Рик. Он был заменён после кронненберг-инцидента.",
        "full_text": "После кронненберг-катастрофы Рик и Морти перешли в другое измерение, где их версии погибли. Но нет доказательств, что это был именно их первый переход.",
        "evidence": "Показана замена реальности. Морти стал более компетентным внезапно. Могло быть несколько замен.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f.png"
    },
    {
        "title": "Рик создал мультивселенную",
        "type": "science",
        "probability": "low",
        "author": "Светлана Физик",
        "summary": "Рик случайно создал мультивселенную своим первым экспериментом с порталом, и теперь пытается это исправить.",
        "full_text": "Первый портал Рика мог разорвать реальность и создать бесконечные копии вселенных. Его поиски убийцы жены - попытка предотвратить это событие.",
        "evidence": "Портал-технология нарушает законы физики. Рик винит себя во многом. Временные парадоксы существуют.",
        "category": "Наука",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/5d6e7f8a-9b0c-1d2e-3f4a-5b6c7d8e9f0a.png"
    },
    {
        "title": "Джерри и Бет должны развестись",
        "type": "character",
        "probability": "medium",
        "author": "Алексей Психолог",
        "summary": "Их отношения токсичны, и развод сделает обоих счастливее, как показано в альтернативных вселенных.",
        "full_text": "Во вселенных, где они развелись, оба стали успешнее и счастливее. Их брак держится только на страхе одиночества и детях.",
        "evidence": "Альтернативные версии успешнее. Они постоянно ссорятся. Их терапия не помогает.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/7e8f9a0b-1c2d-3e4f-5a6b-7c8d9e0f1a2b.png"
    },
    {
        "title": "Существует анти-Рик",
        "type": "multiverse",
        "probability": "medium",
        "author": "Наталья Мечтательница",
        "summary": "Где-то существует добрая версия Рика, которая помогает людям вместо того, чтобы разрушать.",
        "full_text": "В бесконечной мультивселенной должен существовать Рик с противоположными качествами - добрый, альтруистичный, любящий семью. Он может стать союзником.",
        "evidence": "Простой Рик был добрее. Существуют разные версии каждого. Бесконечность подразумевает все варианты.",
        "category": "Мультивселенная",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/9f0a1b2c-3d4e-5f6a-7b8c-9d0e1f2a3b4c.png"
    },
    {
        "title": "Морти нужен Рику для маскировки",
        "type": "science",
        "probability": "confirmed",
        "author": "Павел Научный",
        "summary": "Волны мозга Морти маскируют гениальность Рика от врагов.",
        "full_text": "Рик прямо сказал, что волны мозга Морти нейтрализуют его собственные. Это защищает его от обнаружения другими Риками и врагами.",
        "evidence": "Рик озвучил это в сериале. Морти всегда с Риком. Другие Рики тоже путешествуют с Морти.",
        "category": "Наука",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d.png"
    },
    {
        "title": "Финал - объединение всех вселенных",
        "type": "future",
        "probability": "medium",
        "author": "Татьяна Финалистка",
        "summary": "Сериал закончится объединением всех вселенных в одну, уничтожив мультивселенную.",
        "full_text": "Конечная цель может быть в упрощении реальности. Злой Морти начал процесс разрушения барьеров между вселенными. Финал покажет слияние всего в одну реальность.",
        "evidence": "Злой Морти разрушил ЦКК. Границы между вселенными слабеют. Рик устал от бесконечности.",
        "category": "Будущее",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/3b4c5d6e-7f8a-9b0c-1d2e-3f4a5b6c7d8e.png"
    },
    {
        "title": "Рик специально уничтожил свою вселенную",
        "type": "character",
        "probability": "low",
        "author": "Иван Конспиратор",
        "summary": "Кронненберг-катастрофа была специально устроена Риком, чтобы сбежать от последствий своих действий.",
        "full_text": "Рик мог намеренно испортить лекарство, чтобы получить повод сменить вселенную. Это объясняет его быструю готовность к переезду.",
        "evidence": "Рик редко ошибается. У него была готова новая вселенная. Он не пытался исправить катастрофу.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/5c6d7e8f-9a0b-1c2d-3e4f-5a6b7c8d9e0f.png"
    },
    {
        "title": "Каждый эпизод - новая вселенная",
        "type": "multiverse",
        "probability": "low",
        "author": "Юлия Наблюдательница",
        "summary": "Рик и Морти меняют вселенные между эпизодами, объясняя несостыковки в сюжете.",
        "full_text": "Мелкие различия между эпизодами могут означать, что они прыгают между похожими вселенными. Это объясняет забытые сюжетные линии и изменения характеров.",
        "evidence": "Детали меняются между сериями. Рик легко переключается между вселенными. Некоторые события забываются.",
        "category": "Мультивселенная",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/7d8e9f0a-1b2c-3d4e-5f6a-7b8c9d0e1f2a.png"
    },
    {
        "title": "Саммер - случайность",
        "type": "character",
        "probability": "medium",
        "author": "Роман Реалист",
        "summary": "В большинстве вселенных Саммер не существует, что делает её уникальной и ценной.",
        "full_text": "Показано, что в некоторых вселенных Бет сделала аборт. Это значит, что Саммер - редкость в мультивселенной, что может дать ей особую роль.",
        "evidence": "Рик показывал вселенные без Саммер. Аборт упоминался. Саммер переживала по этому поводу.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/9e0f1a2b-3c4d-5e6f-7a8b-9c0d1e2f3a4b.png"
    },
    {
        "title": "Портал-пушка - живое существо",
        "type": "science",
        "probability": "low",
        "author": "Виктория Мистик",
        "summary": "Портал-пушка обладает собственным сознанием и манипулирует Риком.",
        "full_text": "Пушка всегда возвращается к Рику, даже через вселенные. Она может иметь собственную волю и цели, используя Рика для путешествий.",
        "evidence": "Пушка всегда находится. Она работает интуитивно. Рик зависим от неё.",
        "category": "Наука",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/1f2a3b4c-5d6e-7f8a-9b0c-1d2e3f4a5b6c.png"
    },
    {
        "title": "Мистер Жопосранчик был настоящим",
        "type": "character",
        "probability": "low",
        "author": "Денис Философ",
        "summary": "Рик создал Мистера Жопосранчика с реальным сознанием, и он страдал по-настоящему.",
        "full_text": "Крик о помощи был не шуткой, а настоящей мольбой о спасении. Рик создал разумное существо только для того, чтобы оно передавало масло.",
        "evidence": "Жопосранчик демонстрировал эмоции. Он понял свою цель и ужаснулся. Рик не отрицал его сознание.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/3a4b5c6d-7e8f-9a0b-1c2d-3e4f5a6b7c8d.png"
    },
    {
        "title": "Рик боится терапии",
        "type": "character",
        "probability": "high",
        "author": "Анастасия Терапевт",
        "summary": "Рик избегает психологов, потому что боится столкнуться с собственной травмой и изменить ся.",
        "full_text": "Эпизод с терапевтом показал, что Рик боится быть уязвимым. Он скорее разрушит систему, чем признает свои проблемы.",
        "evidence": "Рик превратил терапевта в огурец. Он издевается над психологией. Он отказывается от помощи.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/5b6c7d8e-9f0a-1b2c-3d4e-5f6a7b8c9d0e.png"
    },
    {
        "title": "Злой Морти создаст новую ЦКК",
        "type": "future",
        "probability": "medium",
        "author": "Кирилл Пророк",
        "summary": "Злой Морти разрушил старую систему, чтобы создать новую под своим контролем.",
        "full_text": "Разрушение ЦКК было только первым шагом. Злой Морти хочет создать новый порядок, где Морти правят, а Рики служат.",
        "evidence": "Злой Морти стремится к власти. Он понимает систему. У него есть план.",
        "category": "Будущее",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/7c8d9e0f-1a2b-3c4d-5e6f-7a8b9c0d1e2f.png"
    },
    {
        "title": "Рик влюблён в себя из другой вселенной",
        "type": "character",
        "probability": "low",
        "author": "Дарья Романтик",
        "summary": "Истинная любовь Рика - это он сам из другого измерения, где он женщина или другая версия.",
        "full_text": "Рик показывал интерес к себе из других вселенных. Его нарциссизм может быть буквальной любовью к себе через измерения.",
        "evidence": "Рик взаимодействовал с собой романтично. Он эгоцентричен. Он доверяет только себе.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/9d0e1f2a-3b4c-5d6e-7f8a-9b0c1d2e3f4a.png"
    },
    {
        "title": "Морти станет президентом",
        "type": "future",
        "probability": "low",
        "author": "Артём Политик",
        "summary": "В будущем Морти использует опыт приключений, чтобы стать президентом Земли или даже Федерации.",
        "full_text": "Морти показывал лидерские качества и умение манипулировать ситуациями. Его развитие может привести к политической карьере.",
        "evidence": "Морти управлял планетой. Он понимает политику. Он может убеждать людей.",
        "category": "Будущее",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/1e2f3a4b-5c6d-7e8f-9a0b-1c2d3e4f5a6b.png"
    },
    {
        "title": "Реальный Рик умер давно",
        "type": "multiverse",
        "probability": "low",
        "author": "Полина Детектив",
        "summary": "Рик, которого мы видим, - это копия или версия из другой вселенной, заменившая оригинала.",
        "full_text": "Настоящий Рик С-137 мог погибнуть в одном из приключений, и его место занял двойник. Семья даже не заметила подмены.",
        "evidence": "Рик легко меняет реальности. Его характер менялся. Были намёки на прошлые смерти.",
        "category": "Мультивселенная",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/3f4a5b6c-7d8e-9f0a-1b2c-3d4e5f6a7b8c.png"
    },
    {
        "title": "Джерри - клей семьи",
        "type": "character",
        "probability": "medium",
        "author": "Егор Социолог",
        "summary": "Несмотря на кажущуюся бесполезность, именно Джерри держит семью вместе своей обычностью.",
        "full_text": "Джерри - единственный нормальный член семьи. Он даёт точку опоры в хаосе, создаваемом Риком. Без него семья распалась бы.",
        "evidence": "Когда Джерри уходит, семья страдает. Он примиряет всех. Его любовь безусловна.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/5a6b7c8d-9e0f-1a2b-3c4d-5e6f7a8b9c0d.png"
    },
    {
        "title": "Вселенная - эксперимент Рика",
        "type": "science",
        "probability": "low",
        "author": "Валерия Учёный",
        "summary": "Вся вселенная, в которой живёт семья Смитов, - это созданная Риком симуляция для контроля.",
        "full_text": "Рик мог создать карманную вселенную как эксперимент или убежище. Это объясняет его полный контроль над реальностью и пренебрежение к законам физики.",
        "evidence": "Рик создавал вселенные раньше. Он контролирует всё. Реальность подчиняется ему.",
        "category": "Наука",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/7b8c9d0e-1f2a-3b4c-5d6e-7f8a9b0c1d2e.png"
    },
    {
        "title": "Морти С-137 - оригинальный внук",
        "type": "character",
        "probability": "high",
        "author": "Максим Аналитик",
        "summary": "Несмотря на все переходы между вселенными, нынешний Морти действительно оригинальный внук Рика С-137.",
        "full_text": "Их связь слишком сильна для случайности. Рик привязан именно к этому Морти, что объясняет его редкие моменты заботы и защиты.",
        "evidence": "Рик жертвует собой ради Морти. Их воспоминания общие. Связь уникальна.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/9c0d1e2f-3a4b-5c6d-7e8f-9a0b1c2d3e4f.png"
    },
    {
        "title": "Сериал - терапия для Рика",
        "type": "science",
        "probability": "low",
        "author": "Светлана Психолог",
        "summary": "Всё, что мы видим - это терапевтическая симуляция, помогающая Рику справиться с травмой потери жены.",
        "full_text": "Сериал может быть симуляцией, созданной для лечения Рика от ПТСР после смерти Дианы. Все приключения - попытка его разума залечить раны.",
        "evidence": "Слишком много абсурда. Рик контролирует реальность. Терапия была важной темой.",
        "category": "Наука",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/1d2e3f4a-5b6c-7d8e-9f0a-1b2c3d4e5f6a.png"
    },
    {
        "title": "Бет станет следующим Риком",
        "type": "future",
        "probability": "medium",
        "author": "Андрей Футурист",
        "summary": "Бет унаследует гений отца и станет следующим поколением безумного учёного.",
        "full_text": "Бет показывала признаки гениальности и склонность к жестокости, как у Рика. Её космическая версия доказывает этот потенциал.",
        "evidence": "Бет - талантливый хирург. Космическая Бет успешна. Она дочь гения.",
        "category": "Будущее",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/3e4f5a6b-7c8d-9e0f-1a2b-3c4d5e6f7a8b.png"
    },
    {
        "title": "Простой Рик - самый счастливый",
        "type": "character",
        "probability": "confirmed",
        "author": "Ольга Философ",
        "summary": "Рик, который отказался от науки и остался с семьёй, нашёл истинное счастье.",
        "full_text": "Простой Рик доказал, что можно быть счастливым без гениальности. Его любовь к дочери оказалась ценнее всех открытий.",
        "evidence": "Простой Рик был счастлив. Его воспоминания ценнее всех. Рик С-137 завидует ему.",
        "category": "Персонажи",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c.png"
    },
    {
        "title": "Финал - Морти убьёт Рика",
        "type": "future",
        "probability": "medium",
        "author": "Николай Драматург",
        "summary": "Сериал закончится тем, что Морти будет вынужден убить Рика, чтобы спасти мультивселенную.",
        "full_text": "Злой Морти показал, что это возможно. Если Рик станет угрозой, Морти должен будет остановить его, повторяя цикл насилия.",
        "evidence": "Злой Морти контролировал Рика. Морти способен на жестокость. Их отношения токсичны.",
        "category": "Будущее",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d.png"
    },
    {
        "title": "Рик создаст машину времени",
        "type": "science",
        "probability": "low",
        "author": "Дмитрий Временщик",
        "summary": "Рик намеренно избегает путешествий во времени, но в финале будет вынужден создать машину времени.",
        "full_text": "Рик называет путешествия во времени запрещёнными, но это может быть ложью. В критический момент он создаст машину времени, чтобы спасти семью или исправить ошибку прошлого.",
        "evidence": "Рик упоминал временные путешествия. Он создал ящик неопределённости. Он способен на это.",
        "category": "Наука",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/9b0c1d2e-3f4a-5b6c-7d8e-9f0a1b2c3d4e.png"
    },
    {
        "title": "Все Морти - клоны одного",
        "type": "multiverse",
        "probability": "low",
        "author": "Елена Биолог",
        "summary": "Все Морти во всех вселенных - это клоны одного оригинального Морти, созданные Риками.",
        "full_text": "Слишком много совпадений между Морти. Возможно, Рики клонируют идеального Морти для своих целей, распространяя его через вселенные.",
        "evidence": "Морти очень похожи. Все Рики имеют Морти. Клонирование - обычная технология Рика.",
        "category": "Мультивселенная",
        "image": "https://poehali.s3.eu-north-1.amazonaws.com/files/1c2d3e4f-5a6b-7c8d-9e0f-1a2b3c4d5e6f.png"
    }
]

def escape_sql(value: str) -> str:
    """Escape single quotes for SQL"""
    if value is None:
        return ''
    return str(value).replace("'", "''")

def handler(event: Dict[str, Any], context: Any) -> Dict[str, Any]:
    method: str = event.get('httpMethod', 'GET')
    
    if method == 'OPTIONS':
        return {
            'statusCode': 200,
            'headers': {
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Methods': 'GET, OPTIONS',
                'Access-Control-Allow-Headers': 'Content-Type',
                'Access-Control-Max-Age': '86400'
            },
            'body': '',
            'isBase64Encoded': False
        }
    
    DATABASE_URL = os.environ.get('DATABASE_URL')
    if not DATABASE_URL:
        return {
            'statusCode': 500,
            'headers': {'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*'},
            'body': json.dumps({'error': 'DATABASE_URL not configured'}),
            'isBase64Encoded': False
        }
    
    conn = psycopg2.connect(DATABASE_URL)
    cur = conn.cursor()
    
    try:
        inserted_count = 0
        
        for theory in THEORIES_DATA:
            sql = f"""
            INSERT INTO theories (
                title, type, probability, author, summary, full_text, 
                evidence, category, image, votes, views, likes, status,
                published_date
            ) VALUES (
                '{escape_sql(theory.get('title', ''))}',
                '{escape_sql(theory.get('type', 'character'))}',
                '{escape_sql(theory.get('probability', 'medium'))}',
                '{escape_sql(theory.get('author', ''))}',
                '{escape_sql(theory.get('summary', ''))}',
                '{escape_sql(theory.get('full_text', ''))}',
                '{escape_sql(theory.get('evidence', ''))}',
                '{escape_sql(theory.get('category', ''))}',
                '{escape_sql(theory.get('image', ''))}',
                {int(theory.get('votes', 0)) if theory.get('votes') else 0},
                {int(theory.get('views', 0)) if theory.get('views') else 0},
                {int(theory.get('likes', 0)) if theory.get('likes') else 0},
                'published',
                NOW()
            )
            """
            
            cur.execute(sql)
            inserted_count += 1
        
        conn.commit()
        
        return {
            'statusCode': 200,
            'headers': {'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*'},
            'isBase64Encoded': False,
            'body': json.dumps({
                'success': True,
                'theories_inserted': inserted_count,
                'message': f'Успешно добавлено {inserted_count} теорий'
            })
        }
    
    except Exception as e:
        conn.rollback()
        return {
            'statusCode': 500,
            'headers': {'Content-Type': 'application/json', 'Access-Control-Allow-Origin': '*'},
            'isBase64Encoded': False,
            'body': json.dumps({
                'error': str(e),
                'message': 'Ошибка при заполнении теорий'
            })
        }
    
    finally:
        cur.close()
        conn.close()
