# Инструкция по генерации SQL комментариев для эпизодов

## Что нужно сделать:

У вас есть готовый Python скрипт `generate_full_comments.py` в корне проекта `/webapp/`.

### Шаг 1: Запустить генерацию SQL файла

```bash
cd /webapp
python3 generate_full_comments.py > db_migrations/V0034__fill_episode_comments.sql
```

### Шаг 2: Проверить созданный файл

```bash
wc -l db_migrations/V0034__fill_episode_comments.sql
```

Должно быть примерно 3000-5000 строк (зависит от рандомного количества комментариев).

### Шаг 3: Выполнить миграцию (когда будете готовы)

```bash
# Через ваш инструмент миграций, например:
psql $DATABASE_URL < db_migrations/V0034__fill_episode_comments.sql
```

## Что делает скрипт:

1. **Генерирует комментарии для 51 эпизода** (5 сезонов Рик и Морти)
2. **От 30 до 100 комментариев** на каждый эпизод (случайное количество)
3. **Использует 32 разных имени** (Рик С-137, Морти Смит, Саммер, Джерри, Бет, Птичья Личность, Мистер Жопосранчик, Мистер Попибаттхол, + 24 русских имени)
4. **Разнообразные комментарии** с учетом сезона (разные шаблоны для сезонов 1-5)
5. **Правильное распределение рейтингов**: 60% - 5 звезд, 30% - 4 звезды, 10% - 3 звезды
6. **Аватары в стиле Rick & Morty** через DiceBear API (fun-emoji стиль)
7. **Временные метки** от 100+ дней назад до нескольких часов назад
8. **Экранирование SQL** (одинарные кавычки в именах и тексте)
9. **Разбивка на части** по 500 комментариев в каждом INSERT запросе (для производительности)

## Структура SQL файла:

```sql
-- Заполнение комментариев к эпизодам
-- Генерируем от 30 до 100 комментариев для каждого эпизода

-- Часть 1: Комментарии 1-500
INSERT INTO episode_comments (episode_id, author_name, author_avatar, comment_text, rating, created_at) VALUES
(1, 'Рик С-137', 'https://api.dicebear.com/7.x/fun-emoji/svg?seed=...', 'Пилот просто бомба!', 5, NOW() - INTERVAL '45 days'),
(1, 'Александр', 'https://api.dicebear.com/7.x/fun-emoji/svg?seed=...', 'Отличное начало сериала', 5, NOW() - INTERVAL '44 days'),
...
(10, 'Анастасия', 'https://api.dicebear.com/7.x/fun-emoji/svg?seed=...', 'Гениальный сезон', 4, NOW() - INTERVAL '5 hours');

-- Часть 2: Комментарии 501-1000
INSERT INTO episode_comments (episode_id, author_name, author_avatar, comment_text, rating, created_at) VALUES
...
```

## Альтернатива: SQL файл уже готов

Если вы хотите, я могу создать полный SQL файл прямо сейчас с помощью Python.

## Что входит в генерируемые данные:

### Имена (32 варианта):
- **Персонажи R&M**: Рик С-137, Морти Смит, Саммер, Джерри, Бет, Птичья Личность, Мистер Жопосранчик, Мистер Попибаттхол
- **Русские имена**: Александр, Дмитрий, Анна, Елена, Сергей, Ольга, Максим, Мария, Владимир, Ирина, Андрей, Екатерина, Николай, Светлана, Алексей, Наталья, Павел, Татьяна, Иван, Юлия, Роман, Виктория, Денис, Анастасия

### Шаблоны комментариев:

**Сезон 1** (30 шаблонов):
- "Пилот просто бомба!"
- "Отличное начало сериала"
- "Морти в этой серии просто шедевр"
- "Классика!"
- "Юмор на высоте"
- "Портал-пушка - лучшее изобретение Рика!"
- "Браво создателям!"
- ... и еще 23 варианта

**Сезон 2** (30 шаблонов):
- "Второй сезон не разочаровал!"
- "Сюжет становится интереснее"
- "Рик снова всех переиграл"
- "Лучший эпизод сезона!"
- "Гениальный сценарий"
- ... и еще 25 вариантов

**Сезон 3** (30 шаблонов):
- "Третий сезон просто космос!"
- "Философия сериала поражает"
- "Рик С-137 лучший Рик!"
- "Эмоциональная серия"
- "Глубокий смысл"
- ... и еще 25 вариантов

**Сезоны 4-5** (по 30 шаблонов):
- "Сезон не подкачал"
- "Креативность зашкаливает"
- "Рик и Морти форевер!"
- "Каждая серия - шедевр"
- "Сериал века!"
- ... и еще 25 вариантов

### Эпизоды (51 total):
- **Сезон 1**: 11 эпизодов (IDs 1-11)
- **Сезон 2**: 10 эпизодов (IDs 12-21)
- **Сезон 3**: 10 эпизодов (IDs 22-31)
- **Сезон 4**: 10 эпизодов (IDs 32-41)
- **Сезон 5**: 10 эпизодов (IDs 42-51)

## Итоговая статистика:

- **Всего эпизодов**: 51
- **Среднее комментариев на эпизод**: ~65
- **Приблизительно комментариев**: ~3315
- **Размер SQL файла**: ~2-3 MB
- **Количество INSERT запросов**: ~7 (по 500 комментариев в каждом)

## Готово к использованию!

Просто запустите:
```bash
python3 /webapp/generate_full_comments.py > /webapp/db_migrations/V0034__fill_episode_comments.sql
```

И у вас будет готовый SQL файл для миграции!